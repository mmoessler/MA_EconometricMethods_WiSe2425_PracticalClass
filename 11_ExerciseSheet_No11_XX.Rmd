---
output:
  html_document:
    css: !expr c("./assets/style.css")
    includes:
      in_header: !expr c("./assets/header_01.html")
params:
  dat_link_01: "https://ilias.uni-hohenheim.de/goto.php?target=file_1558777_download&client_id=UHOH"
  dat_nam_01: "us_macro_data"
editor_options: 
  chunk_output_type: console
---

<!--..........................................................................-->
<!--..........................................................................-->

<!-- Include header -->

````{=html}
```{r, include=TRUE, echo=FALSE, results='asis'}
xfun::file_string('./assets/header_02.html')
```
````

<!--..........................................................................-->
<!--..........................................................................-->

```{r,include=FALSE}

library(knitr)
knitr::opts_chunk$set(
  include=FALSE,
  echo = FALSE,
  warning = FALSE,
  message = FALSE,
  fig.height = 8,
  fig.width = 10,
  fig.align = 'center')
options(scipen=1)
options(width=9999)
# See: https://stackoverflow.com/questions/36230790/missing-horizontal-scroll-bar-in-r-markdown-html-code-chunks-and-output

```

```{r}

# # 1) clear workspace # exclude to be able to use params in yml header!
# rm(list=ls(all=TRUE))

# 2) load libraries
library(kableExtra)
library(texreg)

# 3) load r-scripts
source("./r-scripts/r_helper_functions.R")
source("./r-scripts/texreg_extract_fun_02.R")

# 4) load data
macro.dat <- read.table("./data-sets/us_macro_data.txt",
                        header = TRUE,
                        sep = ",",
                        colClasses = c("character","numeric","numeric","numeric"))

```

```{r,klippy, echo=FALSE, include=TRUE}

# See: https://rlesur.github.io/klippy/articles/klippy.html
klippy::klippy(tooltip_message = 'Click to copy', tooltip_success = 'Done', position = c('top', 'right'))

```

<!--..........................................................................-->
<!--..........................................................................-->

<hr />

<!--..........................................................................-->
# Exercise Sheet No 11 {.tabset .tabset-fade}
<!--..........................................................................-->

<hr />

<p class="head01">
Regression Analysis of Time Series Data (Part 1)
</p>

<hr />

<!--..........................................................................-->
## Set-Up

<span style="text-decoration: none; font-size: 18pt">
1)
</span>
<span style="text-decoration: underline; font-size: 18pt">
Create your (working) directory
</span>

Create a new folder on your computer in which you can save all necessary files, i.e., the data set, the <span class="R">R</span> *script* with the implementation of your analysis and the <span class="R">R</span> *helper function script* with some helper functions provided by us.

This folder, i.e., the path or directory of this folder, will be your so-called working directory.

<hr />

<span style="text-decoration: none; font-size: 18pt">
2)
</span>
<span style="text-decoration: underline; font-size: 18pt">
Download the data set
</span>

<!-- Download the data sets `CASchools_01_data` from <span class="R">ILIAS</span> directly or by using the link below: -->

<!-- <p class="down01"> -->
<!-- <a href="https://ilias.uni-hohenheim.de/goto.php?target=file_1523858_download&client_id=UHOH">Download `CASchools_01_data.txt`</a> -->
<!-- </p> -->

Download the data set ``r params$dat_nam_01`` from <span class="R">ILIAS</span> directly or by using the link below:

<p class="down01">
<a href="`r params$dat_link_01`">Download ``r params$dat_nam_01``</a>
</p>

Save the data set into a (working) directory of your choice.

<hr />

<span style="text-decoration: none; font-size: 18pt">
3)
</span>
<span style="text-decoration: underline; font-size: 18pt">
Prepare *script*
</span>

Open a new <span class="R">R</span> *script* and save it into into your (working) directory.

Run the following code chunk to prepare your <span class="R">R</span> *script*, i.e., to clear the work space and set your working directory.

```{r,include=TRUE,echo=TRUE,eval=FALSE}

# Clear workspace
rm(list = ls(all = TRUE))
# Set working directory
setwd(".../set/your/working/directory/...")

```

<hr />

<div style="display:none">

<span style="text-decoration: none; font-size: 18pt">
X)
</span>
<span style="text-decoration: underline; font-size: 18pt">
Install *libraries*
</span>

Run the following code chunk to make sure that all necessary *libraries* are installed.

*Note*, You have to run this code chunk only once. After running this code chunk you have installed all necessary *libraries* for the class and we will load them whenever we need them.

```{r,include=TRUE,echo=TRUE,eval=TRUE,include=FALSE}

# packages we will use in the course
pac <- c("moments", "sandwich", "lmtest", "AER", "car", "plm", "ivreg", "dynlm", "forecast", "urca")

# install and/or load packages
checkpac <- function(x) {
  if (!require(x, character.only = TRUE)) {
    install.packages(x)
  }
  require(x, character.only = TRUE)
}

# check if packages are install yet
suppressWarnings(sapply(pac, checkpac))

```

<hr />

</div>

<span style="text-decoration: none; font-size: 18pt">
4)
</span>
<span style="text-decoration: underline; font-size: 18pt">
Install/load *packages* and download/save/include *helper function script*
</span>

<span style="text-decoration: underline">Step 1</span>) Install all relevant <span class="R">R</span> *packages* and download and save the <span class="R">R</span> *script* `r_helper_functions.R` from <span class="R">ILIAS</span> by running the following code chunk.

```{r,include=TRUE,echo=TRUE,eval=FALSE}

# Download R-helper functions
source("https://ilias.uni-hohenheim.de/data/UHOH/lm_data/lm_1856939/MA_EconometricMethods_WiSe2324_PracticalClass/r-scripts/prepare_r_packages_and_helper_functions.R")

```

*Note*, the required <span class="R">R</span> *packages* are `"moments"`, `"sandwich"`, `"lmtest"`, `"lmtest"`, `"car"`, `"plm"`, `"ivreg"`, `"dynlm"`, `"forecast"`, `"urca"`.

<div style="margin-top: 5px;">
<span style="text-decoration: underline">Step 2</span>) Include the <span class="R">R</span> *script* `r_helper_functions.R` into your <span class="R">R</span> *script* by running the following code chunk.
</div>

```{r,include=TRUE,echo=TRUE,eval=FALSE}

# Include R-helper functions
source("r_helper_functions.R")

```

*Note*, more information on the helper functions can be found [here](./00_ExerciseSheet_HelperFunctions_XX.html).





<!--..........................................................................-->
<!-- <hr /> -->

## Task {.tabset .tabset-fade}

<hr />

<p class="head01">
US Real Gross Domestic Product (GDP)
</p>

We return to the analysis of US Real Gross Domestic Product (GDP). For this we use the data set `us_macro_data.txt` containing quarterly US macro data from 1955:Q2 - 2017:Q4 with the variables described in Table 1 on the exercise sheet and depicted in Figure 1 on the exercise sheet. 

<!-- We return to the analysis of US Real Gross Domestic Product (GDP). For this we use the data set `us_macro_data.txt` containing quarterly US macro data from 1955:Q1 - 2017:Q4 with the variables described below.  -->

<!--..........................................................................-->
<button type="button" class="collapsible02"> *Show Variable description* </button>
<div class="content01">

| Variable  | Description                               | 
|-----------|-------------------------------------------| 
| $GDP$     | Real GDP in Billions of \$2009            | 
| $GDPGR$   | Annualized real GDP growth                | 
| $TSpread$ | Spread between 10Y and 3M treasury yields | 

</div>
<!--..........................................................................-->

```{r,include=FALSE}

# Transform all macro variables
macro.ts <- ts(macro.dat[,-1], frequency = 4, start = c(1955, 2), end = c(2017, 4)) # I omit the date 

# Estimation using dynlm
ar01.dynlm <- dynlm(GDPGR ~ L(GDPGR,1),
                    data = macro.ts,
                    start = c(1962, 1), end = c(2017, 3))
# Robust inference
ct.ar01.dynlm <- coeftest(ar01.dynlm, vcov=vcovHC(ar01.dynlm, type="HC0"))
ct.ar01.dynlm

# Estimation using dynlm
ar02.dynlm <- dynlm(GDPGR ~ L(GDPGR,1) + L(GDPGR,2),
                    data = macro.ts,
                    start = c(1962, 1), end = c(2017, 3))
# Robust inference
ct.ar02.dynlm <- coeftest(ar02.dynlm, vcov=vcovHC(ar02.dynlm, type="HC0"))
ct.ar02.dynlm

# Estimation using dynlm
adl.dynlm <- dynlm(GDPGR ~ L(GDPGR,1) + L(GDPGR,2) + L(TSpread,1) + L(TSpread,2),
                   data = macro.ts,
                   start = c(1962, 1), end = c(2017, 3))
# Robust inference
ct.adl.dynlm <- coeftest(adl.dynlm, vcov=vcovHC(adl.dynlm, type="HC1"))
ct.adl.dynlm

se.01 <- ct.ar01.dynlm[, 2]
pval.01 <- ct.ar01.dynlm[, 4]

se.02 <- ct.ar02.dynlm[, 2]
pval.02 <- ct.ar02.dynlm[, 4]

se.03 <- ct.adl.dynlm[, 2]
pval.03 <- ct.adl.dynlm[, 4]

```

<!--..........................................................................-->
<button type="button" class="collapsible01"> *Show Estimation Results* </button>
<div class="content01">

```{r,include=TRUE}

screenreg(list(ar01.dynlm, ar02.dynlm, adl.dynlm),
          override.se = list(se.01, se.02, se.03),
          override.pvalues = list(pval.01, pval.02, pval.03),
          custom.coef.names = c("constant","GDPGR_L1", "GDPGR_L2","TSpread_L1", "TSpread_L2"),
          stars = NULL,
          single.row = TRUE,
          digits = 3)

```

</div>
<!--..........................................................................-->

<!--..........................................................................-->
<button type="button" class="collapsible01"> *Show Last Observations* </button>
<div class="content01">
```{r,include=TRUE,echo=FALSE,results=TRUE}
# Collect last values
obs.mat <- as.matrix(tail(macro.ts))
tab <- obs.mat[,-1]
# Label results
rownames(tab) <- c("2016-Q3","2016-Q4","2017-Q1","2017-Q2","2017-Q3","2017-Q4")
# Return results
round(tab, 2)
```
</div>
<!--..........................................................................-->




<!--..........................................................................-->
<hr />

<!--..........................................................................-->
### Task a) 
<!--..........................................................................-->

Briefly describe the time series plot of GDP in levels and the growth rate of GDP depicted in Figure 1 on the exercise sheet.

<hr />

<p class="head02">
Load data set
</p>

<!--..........................................................................-->
<button type="button" class="collapsible01"> *Show Code* </button>
<div class="cod_content">
```{r,include=TRUE,echo=TRUE,results=FALSE,eval=FALSE}
# use absolute or relative path to load data
macro.dat <- read.table("us_macro_data.txt",
                        header = TRUE,
                        sep = ",",
                        colClasses = c("character","numeric","numeric","numeric"))
```
</div>
<!--..........................................................................-->

<hr />

<p class="head02">
Transform variables into `ts` class
</p>

<!--..........................................................................-->
<button type="button" class="collapsible01"> *Show Code* </button>
<div class="content01">
```{r,include=TRUE,echo=TRUE,results=FALSE,fig.show='hide'}
# Transform all macro variables
macro.ts <- ts(macro.dat[,-1], frequency = 4, start = c(1955, 2), end = c(2017, 4)) # I omit the date 
# Transform GDP level series
gdp.ts <- ts(macro.dat$GDP, frequency = 4, start = c(1955, 2), end = c(2017, 4))
# Transform GDP growth series
gdp.grw.ts <- ts(macro.dat$GDPGR, frequency = 4, start = c(1955, 2), end = c(2017, 4))
```
</div>
<!--..........................................................................-->

<hr />

<p class="head02">
Create date variable with class `Date`
</p>

<!--..........................................................................-->
<button type="button" class="collapsible01"> *Show Code* </button>
<div class="content01">
```{r,include=TRUE,echo=TRUE,results=FALSE,fig.show='hide'}
# Transform variable
TT <- length(macro.dat$DATE)
tax <- seq(as.Date("1955/4/1"), by = "quarter", length.out = TT)
```
</div>
<!--..........................................................................-->

<hr />

<p class="head02">
Plot
</p>

<!--..........................................................................-->
<button type="button" class="collapsible01"> *Show Code* </button>
<div class="content01">
```{r,include=TRUE,echo=TRUE,results=FALSE,fig.show='hide'}
# Time series plot of GDP
plot(x = tax, y = macro.dat$GDP, type = "l",
     main = "US real GDP",
     xlab = "Quarter",
     ylab = "Level")
# Time series plot of GDPGR
plot(x = tax, y = macro.dat$GDPGR, type = "l",
     main = "US real GDP growth",
     xlab = "Quarter",
     ylab = "Annual growth rate")
lines(x = tax, y = rep(0,TT), type = "l", lty = 2)
# Time series plot of TSpread
plot(x = tax, y = macro.dat$TSpread, type = "l",
     main = "Term Spread",
     xlab = "Quarter",
     ylab = "Percentage points")
lines(x = tax, y = rep(0,TT), type = "l", lty = 2)
```
</div>
<!--..........................................................................-->
<button type="button" class="collapsible01"> *Show Output* </button>
<div class="content01">
```{r,include=TRUE,echo=FALSE,results=TRUE}
# Time series plot of GDP
plot(x = tax, y = macro.dat$GDP, type = "l",
     main = "US real GDP",
     xlab = "Quarter",
     ylab = "Level")
# Time series plot of GDPGR
plot(x = tax, y = macro.dat$GDPGR, type = "l",
     main = "US real GDP growth",
     xlab = "Quarter",
     ylab = "Annual growth rate")
lines(x = tax, y = rep(0,TT), type = "l", lty = 2)
# Time series plot of TSpread
plot(x = tax, y = macro.dat$TSpread, type = "l",
     main = "Term Spread",
     xlab = "Quarter",
     ylab = "Percentage points")
lines(x = tax, y = rep(0,TT), type = "l", lty = 2)
```
</div>
<!--..........................................................................-->

<hr />

<p class="head02">
Discussion
</p>

<!--..........................................................................-->
<button type="button" class="collapsible02"> *Discussion* </button>
<div class="content01">

<div style="color: red" class="showSol01">

<!-- * There seems to be a (positive) relationship real GDP growth and the term spread. -->
<!-- * Recessions (negative real GDP growth) seems to be associated with an inversion of the yield curve (negative term spread). -->

<!-- <hr /> -->

<p class="head03">
GDP (level)
</p>

* There seems to be a upward trend.
* Standard statistics such as mean and variance are not meaningful!

<hr />

<p class="head03">
GDP (growth rate) and TSpread
</p>

* There seems to be no upward trend.
* Standard statistics such as mean and variance are meaningful.


</div>

<div style="color: red" class="noSol01">

*Add your Interpretation here!*

</div>

</div>
<!--..........................................................................-->





<!--..........................................................................-->
<!-- <hr /> -->

<!--..........................................................................-->
### Task b) 
<!--..........................................................................-->

Explain the concept of sample autocorrelations. Interpret the estimation results for the sample autocorrelations for the growth rate of GDP depicted in Table 3 on the exercise sheet. Why is the sample autocorrelation of GDP in levels not reasonable.

*(In the following tasks we focus on the analysis of the GDP growth rate.)*

<hr />

<p class="head02">
Extract subperiod for replication
</p>

<!--..........................................................................-->
<button type="button" class="collapsible01"> *Show Code* </button>
<div class="content01">
```{r,include=TRUE,echo=TRUE,results=FALSE,fig.show='hide'}
# Select subperiods
gdp.grw.ts.01 <- window(gdp.grw.ts, start = c(1960, 2), end = c(2017, 3))
```
</div>
<!--..........................................................................-->

<hr />

<p class="head02">
Based on Equation 15.4 of Stock and Watson (2020)
</p>

<!--..........................................................................-->
<button type="button" class="collapsible01"> *Show Code* </button>
<div class="content01">
```{r,include=TRUE,echo=TRUE,results=FALSE,fig.show='hide'}
# Use growth rate
ts.ser <- gdp.grw.ts.01
TT <- length(ts.ser)
# Variance
var <- 1/(TT-1)*sum((ts.ser[1:TT]-1/TT*sum(ts.ser[1:TT]))*(ts.ser[1:TT]-1/TT*sum(ts.ser[1:TT])))
# Autocorrelation lag 1
cov.l01 <- 1/TT*sum((ts.ser[2:TT]-1/(TT-1)*sum(ts.ser[2:TT]))*(ts.ser[1:(TT-1)]-1/(TT-1)*sum(ts.ser[1:(TT-1)])))
cor.l01 <- cov.l01/var
round(cor.l01,2)
# Autocorrelation lag 2
cov.l02 <- 1/TT*sum((ts.ser[3:TT]-1/(TT-2)*sum(ts.ser[3:TT]))*(ts.ser[1:(TT-2)]-1/(TT-2)*sum(ts.ser[1:(TT-2)])))
cor.l02 <- cov.l02/var
round(cor.l02,2)
# Autocorrelation lag 3
cov.l03 <- 1/TT*sum((ts.ser[4:TT]-1/(TT-3)*sum(ts.ser[4:TT]))*(ts.ser[1:(TT-3)]-1/(TT-3)*sum(ts.ser[1:(TT-3)])))
cor.l03 <- cov.l03/var
round(cor.l03,2)
# Autocorrelation lag 4
cov.l04 <- 1/TT*sum((ts.ser[5:TT]-1/(TT-4)*sum(ts.ser[5:TT]))*(ts.ser[1:(TT-4)]-1/(TT-4)*sum(ts.ser[1:(TT-4)])))
cor.l04 <- cov.l04/var
round(cor.l04,2)
```
</div>
<!--..........................................................................-->
<button type="button" class="collapsible01"> *Show Output* </button>
<div class="content01">
```{r,include=TRUE,echo=TRUE,results=TRUE}
# Use growth rate
ts.ser <- gdp.grw.ts.01
TT <- length(ts.ser)
# Variance
var <- 1/(TT-1)*sum((ts.ser[1:TT]-1/TT*sum(ts.ser[1:TT]))*(ts.ser[1:TT]-1/TT*sum(ts.ser[1:TT])))
# Autocorrelation lag 1
cov.l01 <- 1/TT*sum((ts.ser[2:TT]-1/(TT-1)*sum(ts.ser[2:TT]))*(ts.ser[1:(TT-1)]-1/(TT-1)*sum(ts.ser[1:(TT-1)])))
cor.l01 <- cov.l01/var
round(cor.l01,2)
# Autocorrelation lag 2
cov.l02 <- 1/TT*sum((ts.ser[3:TT]-1/(TT-2)*sum(ts.ser[3:TT]))*(ts.ser[1:(TT-2)]-1/(TT-2)*sum(ts.ser[1:(TT-2)])))
cor.l02 <- cov.l02/var
round(cor.l02,2)
# Autocorrelation lag 3
cov.l03 <- 1/TT*sum((ts.ser[4:TT]-1/(TT-3)*sum(ts.ser[4:TT]))*(ts.ser[1:(TT-3)]-1/(TT-3)*sum(ts.ser[1:(TT-3)])))
cor.l03 <- cov.l03/var
round(cor.l03,2)
# Autocorrelation lag 4
cov.l04 <- 1/TT*sum((ts.ser[5:TT]-1/(TT-4)*sum(ts.ser[5:TT]))*(ts.ser[1:(TT-4)]-1/(TT-4)*sum(ts.ser[1:(TT-4)])))
cor.l04 <- cov.l04/var
round(cor.l04,2)
```
</div>
<!--..........................................................................-->

<p class="head02">
Results in Table 3 on the exercise sheet
</p>

<!--..........................................................................-->
<button type="button" class="collapsible01"> *Show Code/Output* </button>
<div class="content01">
```{r,include=TRUE,echo=FALSE,results=TRUE}
# Collect results
tab <- rbind(round(cor.l01,2), round(cor.l02,2), round(cor.l03,2), round(cor.l04,2))
# Label results
rownames(tab) <- c("rho_hat_1", "rho_hat_2", "rho_hat_3", "rho_hat_4" )
# Return results
tab
```
</div>
<!--..........................................................................-->

<!--..........................................................................-->
<button type="button" class="collapsible02"> *Note* </button>
<div class="content01">

The results on page 559 of Stock and Watson (2020) are based on the autocorrelation of GDP growth from 1960-Q1 to 2017-Q4 instead of from 1960-Q2 to 2017-Q4 as above.

</div>
<!--..........................................................................-->

<hr />

<p class="head02">
Using the `Acf()` function of the `"forecast"` package
</p>

<!-- .......................................................................... -->
<button type="button" class="collapsible01"> *Show Code* </button>
<div class="content01">

```{r,include=TRUE,echo=TRUE,results=FALSE,fig.show='hide'}
par(mfrow=c(1,1))
# Use forecast package to calculate acf
gdp.grw.02.acf <- Acf(gdp.grw.ts.01, lag.max = 10, type = "correlation", plot = TRUE)
gdp.grw.02.acf
```

</div>
<!-- .......................................................................... -->
<button type="button" class="collapsible01"> *Show Output* </button>
<div class="content01">

```{r,include=TRUE,echo=TRUE,results=TRUE}
par(mfrow=c(1,1))
# Use forecast package to calculate acf
gdp.grw.02.acf <- Acf(gdp.grw.ts.01, lag.max = 10, type = "correlation", plot = TRUE)
gdp.grw.02.acf
```

</div>
<!-- .......................................................................... -->

<!--..........................................................................-->
<!-- <button type="button" class="collapsible02"> *Note* </button> -->
<!-- <div class="content01"> -->

<!-- In the `Acf()` function of the `"forecast"` package the variance is calculated by dividing by $\frac{1}{T}$ instead of $\frac{1}{T-1}$. -->

<!-- This is the calculation of the the `Acf()` of the `"forecast"` package: -->

```{r,include=FALSE,echo=TRUE,results=TRUE}
# Use growth rate
ts.ser <- gdp.grw.ts.01
TT <- length(ts.ser)
# Variance
var <- 1/TT*sum((ts.ser[1:TT]-1/TT*sum(ts.ser[1:TT]))*(ts.ser[1:TT]-1/TT*sum(ts.ser[1:TT])))
# Autocorrelation lag 1
cov.l01 <- 1/TT*sum((ts.ser[2:TT]-1/(TT-1)*sum(ts.ser[2:TT]))*(ts.ser[1:(TT-1)]-1/(TT-1)*sum(ts.ser[1:(TT-1)])))
cor.l01 <- cov.l01/var
round(cor.l01,3)
# Autocorrelation lag 2
cov.l02 <- 1/TT*sum((ts.ser[3:TT]-1/(TT-2)*sum(ts.ser[3:TT]))*(ts.ser[1:(TT-2)]-1/(TT-2)*sum(ts.ser[1:(TT-2)])))
cor.l02 <- cov.l02/var
round(cor.l02,3)
# Autocorrelation lag 3
cov.l03 <- 1/TT*sum((ts.ser[4:TT]-1/(TT-3)*sum(ts.ser[4:TT]))*(ts.ser[1:(TT-3)]-1/(TT-3)*sum(ts.ser[1:(TT-3)])))
cor.l03 <- cov.l03/var
round(cor.l03,3)
# Autocorrelation lag 4
cov.l04 <- 1/TT*sum((ts.ser[5:TT]-1/(TT-4)*sum(ts.ser[5:TT]))*(ts.ser[1:(TT-4)]-1/(TT-4)*sum(ts.ser[1:(TT-4)])))
cor.l04 <- cov.l04/var
round(cor.l04,3)
```

<!-- </div> -->
<!--..........................................................................-->

<hr />

<p class="head02">
Concept, Interpretation and Discussion
</p>

<!--..........................................................................-->
<button type="button" class="collapsible02"> *Interpretation* </button>
<div class="content01">

<div style="color: red" class="showSol01">

<!-- See, WS 21/22, task 1c) -->

<p class="head02">
Concept ACF
</p>

* Linear co-movement between current and lagged observations
  * E.g., $\widehat{\rho}_1$: Estimated correlation between $y_{t}$ and $y_{t-1}$
  * E.g., $\widehat{\rho}_j$: Estimated correlation between $y_{t}$ and $y_{t-j}$
* How useful are lagged observations to predict current observations

<hr>

<p class="head02">
Interpretation
</p>

* The first four autocorrelations are positive.
* $\Rightarrow$ If GDP grows faster than average in one period, it tends to grow faster than average in the following period, too.

<!-- * The first two autocorrelations are significantly different from zero. -->

<hr>

<p class="head02">
Discussion
</p>

* For the sample autocorrelation to be meaningful the sample mean and sample variance have to be stable over time.
* The plot of GDP in levels suggests that the mean and probably also the variance are not stable over time.
* $\Rightarrow$ The sample mean and the sample variance are not meaningful measures and thus the same is true for the sample autocorrelation.

</div>

<div style="color: red" class="noSol01">

*Add your Interpretation here!*

</div>

</div>
<!--..........................................................................-->





<!--..........................................................................-->
<!-- <hr /> -->

<!--..........................................................................-->
### Task c) 
<!--..........................................................................-->

Interpret the estimation result under Model 1 in Table 5 on the exercise sheet. Is the lagged growth rate of GDP a useful predictor of the current growth rate of GDP?

<hr />

<p class="head02">
Estimation
</p>

<!--..........................................................................-->
<button type="button" class="collapsible01"> *Show Code* </button>
<div class="content01">
```{r,include=TRUE,echo=TRUE,results=FALSE}
# Estimation AR(1) model
ar01.dynlm <- dynlm(GDPGR ~ L(GDPGR,1),
                    data = macro.ts,
                    start = c(1962, 1), end = c(2017, 3))
```
</div>
<!--..........................................................................-->

<hr />

<p class="head02">
Robust inference (for replication)
</p>

<!--..........................................................................-->
<button type="button" class="collapsible01"> *Show Code* </button>
<div class="content01">
```{r,include=TRUE,echo=TRUE,results=FALSE}
# Robust inference
ct.ar01.dynlm <- coeftest(ar01.dynlm, vcov=vcovHC(ar01.dynlm, type="HC0"))
ct.ar01.dynlm
```
</div>
<!--..........................................................................-->
<button type="button" class="collapsible01"> *Show Output* </button>
<div class="content01">
```{r,include=TRUE,echo=TRUE,results=TRUE}
# Robust inference
ct.ar01.dynlm <- coeftest(ar01.dynlm, vcov=vcovHC(ar01.dynlm, type="HC0"))
ct.ar01.dynlm
```
</div>
<!--..........................................................................-->

<hr />

<p class="head02">
Estimation results
</p>

<!--..........................................................................-->
<button type="button" class="collapsible01"> *Show Code* </button>
<div class="content01">
```{r,include=TRUE,echo=TRUE,results=FALSE}
# Robust inference
ct.ar01.dynlm <- coeftest(ar01.dynlm, vcov=vcovHC(ar01.dynlm, type="HC0"))
ct.ar01.dynlm
```
</div>
<!--..........................................................................-->
<button type="button" class="collapsible01"> *Show Output* </button>
<div class="content01">
```{r,include=TRUE,echo=TRUE,results=TRUE}
# Robust inference
ct.ar01.dynlm <- coeftest(ar01.dynlm, vcov=vcovHC(ar01.dynlm, type="HC0"))
ct.ar01.dynlm
```
</div>
<!--..........................................................................-->

<hr />

<p class="head02">
Estimation results
</p>

<!--..........................................................................-->
<button type="button" class="collapsible01"> *Show Estimation Results* </button>
<div class="content01">

```{r,include=TRUE}

screenreg(list(ar01.dynlm),
          override.se = list(se.01),
          override.pvalues = list(pval.01),
          custom.coef.names = c("constant","GDPGR_L1"),
          stars = NULL,
          single.row = TRUE,
          digits = 3)

```

</div>
<!--..........................................................................-->

<hr />

<p class="head02">
Interpretation
</p>

<!--..........................................................................-->
<button type="button" class="collapsible02"> *Interpretation* </button>
<div class="content01">

<div style="color: red" class="showSol01">

<!-- See, WS 21/22, task 1d) -->

* Estimated coefficient of the lagged growth rate is highly significant.
* $\Rightarrow$ Lagged growth rate is a useful predictor for current growth rate.

</div>

<div style="color: red" class="noSol01">

*Add your Interpretation here!*

</div>

</div>
<!--..........................................................................-->





<!--..........................................................................-->
<!-- <hr /> -->

<!--..........................................................................-->
### Task d) 
<!--..........................................................................-->

Based on the estimation result under Model 1 in Table 5 on the exercise sheet forecast the growth rate of GDP in period 2017:Q4. Use the last observations depicted in Table 2 of the exercise sheet.

<hr />

<p class="head02">
Last values
</p>

<!--..........................................................................-->
<button type="button" class="collapsible01"> *Show Code/Output* </button>
<div class="content01">
```{r,include=TRUE,echo=FALSE,results=TRUE}
# Collect last values
obs.mat <- as.matrix(tail(macro.ts))
tab <- obs.mat[,-1]
# Label results
rownames(tab) <- c("2016-Q3","2016-Q4","2017-Q1","2017-Q2","2017-Q3","2017-Q4")
# Return results
round(tab, 2)
```
</div>
<!--..........................................................................-->

<hr />

<p class="head02">
Interpretation
</p>

<!--..........................................................................-->
<button type="button" class="collapsible02"> *Interpretation* </button>
<div class="content01">

<div style="color: red" class="showSol01">

<!-- See, WS 21/22, task 1e) -->

<p class="head03">
Prediction
</p>

\begin{align}
\widehat{GDPGR}_{2017:Q4|2017:Q3} &= 1.950 + 0.341 \times GDPGR_{2017:Q3} \\
\widehat{GDPGR}_{2017:Q4|2017:Q3} &= 1.950 + 0.341 \times 3.11 \\
\widehat{GDPGR}_{2017:Q4|2017:Q3} &= 3.01
\end{align}

<p class="head03">
Forecast error
</p>

\begin{align}
GDPGR_{2017:Q4} - \widehat{GDPGR}_{2017:Q4|2017:Q3} &= 2.50 - 3.01\\
&= -0.51 \quad \text{percentage points}
\end{align}

</div>

<div style="color: red" class="noSol01">

*Add your Interpretation here!*

</div>

</div>
<!--..........................................................................-->





<!--..........................................................................-->
<!-- <hr /> -->

<!--..........................................................................-->
### Task e) 
<!--..........................................................................-->

Interpret the estimation result depicted in Table 4 on the exercise sheet. Choose an appropriate AR(p) model for the GDP growth.

<hr />

<p class="head02">
Estimation
</p>

<!--..........................................................................-->
<button type="button" class="collapsible01"> *Show Code* </button>
<div class="content01">
```{r,include=TRUE,echo=TRUE,results=FALSE,fig.show='hide'}
# Transform to ts variable
gdp.grw.ts <- ts(gdp.grw.ts.01, frequency = 4, start = c(1960, 2))
# Estimation using dynlm
ar00.dynlm <- dynlm(gdp.grw.ts ~ 1,
                    start = c(1962, 1), end = c(2017, 3))
ar01.dynlm <- dynlm(gdp.grw.ts ~ L(gdp.grw.ts,1),
                    start = c(1962, 1), end = c(2017, 3))
ar02.dynlm <- dynlm(gdp.grw.ts ~ L(gdp.grw.ts,1) + L(gdp.grw.ts,2),
                    start = c(1962, 1), end = c(2017, 3))
ar03.dynlm <- dynlm(gdp.grw.ts ~ L(gdp.grw.ts,1) + L(gdp.grw.ts,2) + L(gdp.grw.ts,3),
                    start = c(1962, 1), end = c(2017, 3))
ar04.dynlm <- dynlm(gdp.grw.ts ~ L(gdp.grw.ts,1) + L(gdp.grw.ts,2) + L(gdp.grw.ts,3) + L(gdp.grw.ts,4),
                    start = c(1962, 1), end = c(2017, 3))
ar05.dynlm <- dynlm(gdp.grw.ts ~ L(gdp.grw.ts,1) + L(gdp.grw.ts,2) + L(gdp.grw.ts,3) + L(gdp.grw.ts,4) + L(gdp.grw.ts,5),
                    start = c(1962, 1), end = c(2017, 3))
ar06.dynlm <- dynlm(gdp.grw.ts ~ L(gdp.grw.ts,1) + L(gdp.grw.ts,2) + L(gdp.grw.ts,3) + L(gdp.grw.ts,4) + L(gdp.grw.ts,5) + L(gdp.grw.ts,6),
                    start = c(1962, 1), end = c(2017, 3))
```
</div>
<!--..........................................................................-->

<hr />

<p class="head02">
Information criteria
</p>

<!--..........................................................................-->
<button type="button" class="collapsible02"> *Remember* </button>
<div class="content01">

<hr />

<p class="head03">
$R^2$
</p>

\begin{align}
R^2 &= 1 - \frac{SSR}{TSS}
\end{align}

<!--
<hr />

<p class="head03">
$\overline{R}^2$
</p>

\begin{align}
\overline{R}^2 &= 1 - \frac{n-1}{n-k-1} \frac{SSR}{TSS}\\
\end{align}

with an adjustment factor

\begin{align}
\frac{n-1}{n-k-1} > 1.
\end{align}
-->

<hr />

<p class="head03">
BIC
</p>

\begin{align}
BIC\left(p\right)=ln\left[\frac{SSR\left(p\right)}{T}\right]+\left(p+1\right)\frac{ln\left(T\right)}{T}
\end{align}

<hr />

<p class="head03">
AIC
</p>

\begin{align}
AIC\left(p\right)=ln\left[\frac{SSR\left(p\right)}{T}\right]+\left(p+1\right)\frac{2}{T}
\end{align}

</div>
<!--..........................................................................-->

<!--..........................................................................-->
<button type="button" class="collapsible01"> *Show Code* </button>
<div class="content01">
```{r,include=TRUE,echo=TRUE,results=FALSE,fig.show='hide'}
# Call function for information criteria
ar00.crit <- lag_len_crit_fun(ar00.dynlm)
ar01.crit <- lag_len_crit_fun(ar01.dynlm)
ar02.crit <- lag_len_crit_fun(ar02.dynlm)
ar03.crit <- lag_len_crit_fun(ar03.dynlm)
ar04.crit <- lag_len_crit_fun(ar04.dynlm)
ar05.crit <- lag_len_crit_fun(ar05.dynlm)
ar06.crit <- lag_len_crit_fun(ar06.dynlm)
```
</div>
<!--..........................................................................-->

```{r, include=FALSE}

head(ar02.dynlm$model)
class(ar02.dynlm$model)

lm.res <- lm(ar02.dynlm$model[,1] ~ ar02.dynlm$model[,2] + ar02.dynlm$model[,3])
summary(lm.res)

summary(ar02.dynlm)

model <- lm.res

  ssr <- sum(model$residuals^2)
  t <- length(model$residuals)
  ssr.t <- ssr/t
  log.ssr.t <- log(ssr.t)
  
  p <- length(model$coef)-1
  p1.ln.t.t <- (p+1)*log(t)/t
  
  R2 <- summary(model)$r.squared
  BIC <- log(ssr/t) + (p+1) * log(t)/t
  AIC <- log(ssr/t) + (p+1) * 2/t
  
  AIC
  BIC
  
ar02.crit$AIC
ar02.crit$BIC

```










<hr />

<p class="head02">
Results
</p>

<!--..........................................................................-->
<button type="button" class="collapsible01"> *Show Code/Output* </button>
<div class="content01">
```{r,include=TRUE,echo=TRUE,results=TRUE}
# Collect results
res.mat <- rbind(
  cbind(ar00.crit$p,ar00.crit$ssr,ar00.crit$ssr.t,ar00.crit$log.ssr.t,ar00.crit$p1.ln.t.t,ar00.crit$BIC,ar00.crit$AIC,ar00.crit$R2),
  cbind(ar01.crit$p,ar01.crit$ssr,ar01.crit$ssr.t,ar01.crit$log.ssr.t,ar01.crit$p1.ln.t.t,ar01.crit$BIC,ar01.crit$AIC,ar01.crit$R2),
  cbind(ar02.crit$p,ar02.crit$ssr,ar02.crit$ssr.t,ar02.crit$log.ssr.t,ar02.crit$p1.ln.t.t,ar02.crit$BIC,ar02.crit$AIC,ar02.crit$R2),
  cbind(ar03.crit$p,ar03.crit$ssr,ar03.crit$ssr.t,ar03.crit$log.ssr.t,ar03.crit$p1.ln.t.t,ar03.crit$BIC,ar03.crit$AIC,ar03.crit$R2),
  cbind(ar04.crit$p,ar04.crit$ssr,ar04.crit$ssr.t,ar04.crit$log.ssr.t,ar04.crit$p1.ln.t.t,ar04.crit$BIC,ar04.crit$AIC,ar04.crit$R2),
  cbind(ar05.crit$p,ar05.crit$ssr,ar05.crit$ssr.t,ar05.crit$log.ssr.t,ar05.crit$p1.ln.t.t,ar05.crit$BIC,ar05.crit$AIC,ar05.crit$R2),
  cbind(ar06.crit$p,ar06.crit$ssr,ar06.crit$ssr.t,ar06.crit$log.ssr.t,ar06.crit$p1.ln.t.t,ar06.crit$BIC,ar06.crit$AIC,ar06.crit$R2))
colnames(res.mat) <- c("p","SSR(p)","SSR(p)/T","ln(SSR(p)/T)","(p+1)ln(T)/T","BIC(p)","AIC(p)","R2")
# Show results
res.mat
```
</div>
<!--..........................................................................-->

```{r}
tab <- rbind(
  cbind(ar00.crit$p,ar00.crit$ssr,ar00.crit$ssr.t,ar00.crit$log.ssr.t,ar00.crit$p1.ln.t.t,ar00.crit$BIC,ar00.crit$AIC,ar00.crit$R2),
  cbind(ar01.crit$p,ar01.crit$ssr,ar01.crit$ssr.t,ar01.crit$log.ssr.t,ar01.crit$p1.ln.t.t,ar01.crit$BIC,ar01.crit$AIC,ar01.crit$R2),
  cbind(ar02.crit$p,ar02.crit$ssr,ar02.crit$ssr.t,ar02.crit$log.ssr.t,ar02.crit$p1.ln.t.t,ar02.crit$BIC,ar02.crit$AIC,ar02.crit$R2),
  cbind(ar03.crit$p,ar03.crit$ssr,ar03.crit$ssr.t,ar03.crit$log.ssr.t,ar03.crit$p1.ln.t.t,ar03.crit$BIC,ar03.crit$AIC,ar03.crit$R2),
  cbind(ar04.crit$p,ar04.crit$ssr,ar04.crit$ssr.t,ar04.crit$log.ssr.t,ar04.crit$p1.ln.t.t,ar04.crit$BIC,ar04.crit$AIC,ar04.crit$R2),
  cbind(ar05.crit$p,ar05.crit$ssr,ar05.crit$ssr.t,ar05.crit$log.ssr.t,ar05.crit$p1.ln.t.t,ar05.crit$BIC,ar05.crit$AIC,ar05.crit$R2),
  cbind(ar06.crit$p,ar06.crit$ssr,ar06.crit$ssr.t,ar06.crit$log.ssr.t,ar06.crit$p1.ln.t.t,ar06.crit$BIC,ar06.crit$AIC,ar06.crit$R2))
colnames(tab) <- c("p","SSR(p)","SSR(p)/T","ln(SSR(p)/T)","(p+1)ln(T)/T","BIC(p)","AIC(p)","R2")
```

<!--..........................................................................-->
<button type="button" class="collapsible02"> *Results* </button>
<div class="content01">

```{r,include=TRUE,results='asis'}
tab %>%
  kable("html",booktabs=T,escape=F,align=c("l","c","c","c","c","c","c","c"),digits = c(0,2,3,3,3,3,3,3)) %>%
  #add_header_above(c(" ", " " = 2, "Percentile" = 7)) %>%
  kable_styling(latex_options="hold_position") %>%
  row_spec(0,align="c")
```

</div>
<!--..........................................................................-->

<hr />

<p class="head02">
Interpretation
</p>

<!--..........................................................................-->
<button type="button" class="collapsible02"> *Interpretation* </button>
<div class="content01">

<div style="color: red" class="showSol01">

<!-- See, WS 21/22, task 1f) -->

<!-- * Trade off between marginal benefit and marginal costs of including additional lagged variables -->

* Trade off between benefit and costs of including additional lagged variables
  + <u>Benefit</u>: Additional lagged variables potentially contain valuable information
  + <u>Costs</u>: Estimation of more coefficients introduces additional estimation error into the forecasts
* Information Criteria
  + <u>BIC</u>: Choose two lags
  + <u>AIC</u>: Choose two lags
  + $\underline{R^2}$: Always choose longest lag order ($\Rightarrow$ Not useful here!)

</div>

<div style="color: red" class="noSol01">

*Add your Interpretation here!*

</div>

</div>
<!--..........................................................................-->





<!--..........................................................................-->
<!-- <hr /> -->

<!--..........................................................................-->
### Task f) 
<!--..........................................................................-->

Interpret the estimation result under Model 2 in Table 5 on the exercise sheet. Use the  model to forecast the GDP growth for 2017:Q4. Discuss your results.

<hr />

<p class="head02">
Estimation
</p>

<!--..........................................................................-->
<button type="button" class="collapsible01"> *Show Code* </button>
<div class="content01">
```{r,include=TRUE,echo=TRUE,results=FALSE}
# Estimation AR(2) model
ar02.dynlm <- dynlm(GDPGR ~ L(GDPGR,1) + L(GDPGR,2),
                    data = macro.ts,
                    start = c(1962, 1), end = c(2017, 3))
```
</div>
<!--..........................................................................-->

<hr />

<p class="head02">
Robust inference (for replication)
</p>

<!--..........................................................................-->
<button type="button" class="collapsible01"> *Show Code* </button>
<div class="content01">
```{r,include=TRUE,echo=TRUE,results=FALSE}
# Robust inference
ct.ar02.dynlm <- coeftest(ar02.dynlm, vcov=vcovHC(ar02.dynlm, type="HC0"))
ct.ar02.dynlm
```
</div>
<!--..........................................................................-->
<button type="button" class="collapsible01"> *Show Output* </button>
<div class="content01">
```{r,include=TRUE,echo=TRUE,results=TRUE}
# Robust inference
ct.ar02.dynlm <- coeftest(ar02.dynlm, vcov=vcovHC(ar02.dynlm, type="HC0"))
ct.ar02.dynlm
```
</div>
<!--..........................................................................-->

<hr />

<p class="head02">
Estimation results
</p>

<!--..........................................................................-->
<button type="button" class="collapsible01"> *Show Estimation Results* </button>
<div class="content01">

```{r,include=TRUE}

# Estimation AR(1) model
ar01.dynlm <- dynlm(GDPGR ~ L(GDPGR,1),
                    data = macro.ts,
                    start = c(1962, 1), end = c(2017, 3))

screenreg(list(ar01.dynlm, ar02.dynlm),
          override.se = list(se.01, se.02),
          override.pvalues = list(pval.01, pval.02),
          custom.coef.names = c("constant","GDPGR_L1", "GDPGR_L2"),
          stars = NULL,
          single.row = TRUE,
          digits = 3)

```

</div>
<!--..........................................................................-->

<hr />

<p class="head02">
Interpretation I
</p>

<!--..........................................................................-->
<button type="button" class="collapsible02"> *Interpretation I* </button>
<div class="content01">

<div style="color: red" class="showSol01">

<!-- See, WS 21/22, task 1d) -->

* Estimated coefficient of the first and second lagged growth rate are significant.
* $\Rightarrow$ First and second lagged growth rate is a useful predictor of current growth rate.

</div>

<div style="color: red" class="noSol01">

*Add your Interpretation here!*

</div>

</div>
<!--..........................................................................-->

<hr />

<p class="head02">
Forecast
</p>

<!--..........................................................................-->
<button type="button" class="collapsible02"> *Results* </button>
<div class="content01">

<div style="color: red" class="showSol01">

<hr />

<p class="head03">
Prediction
</p>

\begin{align}
\widehat{GDPGR}_{2017:Q4|2017:Q3,2017:Q2} &= 1.603 + 0.279 \times GDPGR_{2017:Q3} + 0.177 \times GDPGR_{2017:Q2} \\
\widehat{GDPGR}_{2017:Q4|2017:Q3,2017:Q2} &= 1.603 + 0.279 \times 3.11 + 0.177 \times 3.01 \\
\widehat{GDPGR}_{2017:Q4|2017:Q3,2017:Q2} &= 3.00
\end{align}

<hr />

<p class="head03">
Forecast error
</p>

\begin{align}
GDPGR_{2017:Q4} - \widehat{GDPGR}_{2017:Q4|2017:Q3} &= 2.50 - 3.00\\
&= -0.50 \quad \text{percentage points}
\end{align}

</div>

<div style="color: red" class="noSol01">

*Add your Interpretation here!*

</div>

</div>
<!--..........................................................................-->

<hr />

<p class="head02">
Interpretation II
</p>

<!--..........................................................................-->
<button type="button" class="collapsible02"> *Interpretation II* </button>
<div class="content01">

<div style="color: red" class="showSol01">

<p class="head03">
Comparison of forecasting error
</p>

* AR(1)-model: $-0.51$ percentage points
* AR(2)-model: $-0.50$ percentage points
* $\Rightarrow$ AR(2)-model has a lower (absolute) forecasting error.

</div>

<div style="color: red" class="noSol01">

*Add your Interpretation here!*

</div>

</div>
<!--..........................................................................-->





<!--..........................................................................-->
<!-- <hr /> -->

<!--..........................................................................-->
### Task g) 
<!--..........................................................................-->

Compare the time series plots of the GDP growth rate and the term spread in Figure 1 on the exercise sheet. Discuss whether the term spread is a potential predictor for future GDP growth.

<hr />

<p class="head02">
Plot
</p>

<!--..........................................................................-->
<button type="button" class="collapsible01"> *Show Code* </button>
<div class="content01">
```{r,include=TRUE,echo=TRUE,results=FALSE,fig.show='hide'}
# Time series plot of GDPGR and term spread
plot(x = tax, y = macro.dat$GDPGR, type = "l", col = "blue",
     main = "US real GDP growth / 10Y-3M Term Spread",
     xlab = "Quarter",
     ylab = "Annual growth rate / Spread")
lines(x = tax, y = macro.dat$TSpread, type = "l", col = "red")
lines(x = tax, y = rep(0,length(tax)), type = "l", lty = 2)
legend("topright",
       legend = c("GDPGR", "TSpread"),
       col = c("blue", "red"),
       lty = 1, inset = 0.01)
```
</div>
<!--..........................................................................-->
<button type="button" class="collapsible01"> *Show Output* </button>
<div class="content01">
```{r,include=TRUE,echo=FALSE,results=TRUE}
# Time series plot of GDPGR and term spread
plot(x = tax, y = macro.dat$GDPGR, type = "l", col = "blue",
     main = "US real GDP growth / 10Y-3M Term Spread",
     xlab = "Quarter",
     ylab = "Annual growth rate / Spread")
lines(x = tax, y = macro.dat$TSpread, type = "l", col = "red")
lines(x = tax, y = rep(0,length(tax)), type = "l", lty = 2)
legend("topright",
       legend = c("GDPGR", "TSpread"),
       col = c("blue", "red"),
       lty = 1, inset = 0.01)
```
</div>
<!--..........................................................................-->

<hr />

<p class="head02">
Interpretation
</p>

<!--..........................................................................-->
<button type="button" class="collapsible02"> *Interpretation* </button>
<div class="content01">

<div style="color: red" class="showSol01">

<!-- See, WS 21/22, task 2a) -->

* There seems to be a (positive) relationship between real GDP growth and the 1Y-3M term spread.
* Recessions (negative real GDP growth) seems to be associated with an inversion of the yield curve (negative term spread).

</div>

<div style="color: red" class="noSol01">

*Add your Interpretation here!*

</div>

</div>
<!--..........................................................................-->





<!--..........................................................................-->
<!-- <hr /> -->

<!--..........................................................................-->
### Task h) 
<!--..........................................................................-->

Interpret the estimation result under Model 3 in Table 5 on the exercise sheet. Use the  model to forecast the GDP growth for 2017:Q4. Discuss your results.

<hr />

<p class="head02">
Estimation
</p>

<!--..........................................................................-->
<button type="button" class="collapsible01"> *Show Code* </button>
<div class="content01">
```{r,include=TRUE,echo=TRUE,results=FALSE}
# Estimation ADL model
adl.dynlm <- dynlm(GDPGR ~ L(GDPGR,1) + L(GDPGR,2) + L(TSpread,1) + L(TSpread,2),
                   data = macro.ts,
                   start = c(1962, 1), end = c(2017, 3))
```
</div>
<!--..........................................................................-->

<hr />

<p class="head02">
Robust inference (for replication)
</p>

<!--..........................................................................-->
<button type="button" class="collapsible01"> *Show Code* </button>
<div class="content01">
```{r,include=TRUE,echo=TRUE,results=FALSE}
# Robust inference
ct.adl.dynlm <- coeftest(adl.dynlm, vcov=vcovHC(adl.dynlm, type="HC1"))
ct.adl.dynlm
```
</div>
<!--..........................................................................-->
<button type="button" class="collapsible01"> *Show Output* </button>
<div class="content01">
```{r,include=TRUE,echo=TRUE,results=TRUE}
# Robust inference
ct.adl.dynlm <- coeftest(adl.dynlm, vcov=vcovHC(adl.dynlm, type="HC1"))
ct.adl.dynlm
```
</div>
<!--..........................................................................-->

<hr />

<p class="head02">
Estimation results
</p>

<!--..........................................................................-->
<button type="button" class="collapsible01"> *Show Estimation Results* </button>
<div class="content01">

```{r,include=TRUE}

screenreg(list(ar01.dynlm, ar02.dynlm, adl.dynlm),
          override.se = list(se.01, se.02, se.03),
          override.pvalues = list(pval.01, pval.02, pval.03),
          # custom.coef.names = c("constant","GDPGR_L1", "GDPGR_L2","TSpread_L1", "TSpread_L2"),
          stars = NULL,
          single.row = TRUE,
          digits = 3)

```

</div>
<!--..........................................................................-->

<hr />

<p class="head02">
Interpretation
</p>

<!--..........................................................................-->
<button type="button" class="collapsible02"> *Interpretation* </button>
<div class="content01">

<div style="color: red" class="showSol01">

<!-- See, WS 21/22, task 1d) -->

* Estimated coefficient of the lagged term spread are not quite significant.
* Using term spread could still reduce the out-of-sample forecasting error.

</div>

<div style="color: red" class="noSol01">

*Add your Interpretation here!*

</div>

</div>
<!--..........................................................................-->

<hr />

<p class="head02">
Forecast
</p>

<!--..........................................................................-->
<button type="button" class="collapsible02"> *Results* </button>
<div class="content01">

<div style="color: red" class="showSol01">

<hr />

<p class="head03">
Prediction
</p>

\begin{align}
\widehat{GDPGR}_{2017:Q4|2017:Q3,2017:Q2} &= 0.945 + 0.246 \times GDPGR_{2017:Q3} + 0.176 \times GDPGR_{2017:Q2} \\
&= -0.134 \times TSpread_{2017:Q3} + 0.623 \times TSpread_{2017:Q2} \\
\widehat{GDPGR}_{2017:Q4|2017:Q3,2017:Q2} &=  0.945 + 0.246 \times 3.11 + 0.176 \times 3.01 \\
&\phantom{=} - 0.13 \times 1.200 + 0.623 \times 1.37 \\
\widehat{GDPGR}_{2017:Q4|2017:Q3,2017:Q2} &= 2.94
\end{align}

<hr />

<p class="head03">
Forecast error
</p>

\begin{align}
GDPGR_{2017:Q4} - \widehat{GDPGR}_{2017:Q4|2017:Q3} &= 2.50 - 2.94\\
&= -0.44 \quad \text{percentage points}
\end{align}

</div>

<div style="color: red" class="noSol01">

*Add your Interpretation here!*

</div>

</div>
<!--..........................................................................-->

<hr />

<p class="head02">
Interpretation II
</p>

<!--..........................................................................-->
<button type="button" class="collapsible02"> *Interpretation II* </button>
<div class="content01">

<div style="color: red" class="showSol01">

<p class="head03">
Comparison of forecasting error
</p>

* AR(1)-model: $-0.51$ percentage points
* AR(2)-model: $-0.50$ percentage points
* ADL-model: $-0.44$ percentage points
* $\Rightarrow$ ADL-model has a lower (absolute) forecasting error.
* $\Rightarrow$ Use so-called pseudo out of sample (POOS) forecast error to compare the three models more more thoroughly.

</div>

<div style="color: red" class="noSol01">

*Add your Interpretation here!*

</div>

</div>
<!--..........................................................................-->





<!--..........................................................................-->
#
<!--..........................................................................-->

<!--..........................................................................-->
<hr />

<p class="back01">
[Back To *Start*](./index.html)
</p>

<!--..........................................................................-->
<hr />





<!--..........................................................................--> 
<!-- THIS IS THE END --> 

<!-- Include bottom -->

````{=html}
```{r, include=TRUE, echo=FALSE, results='asis'}
xfun::file_string('./assets/bottom_01.html')
```
````

````{=html}

<script>

// Hide all solutions (by default)
var i, Sol01;
Sol01 = document.getElementsByClassName("showSol01");
for (i = 0; i < Sol01.length; i++) {
  Sol01[i].style.display = "none"; // type "block" for show or "none" (default) for exclude
}
  
var i, NoSol01;
NoSol01 = document.getElementsByClassName("noSol01");
for (i = 0; i < NoSol01.length; i++) {
  NoSol01[i].style.display = "block"; // type "block" (default) for show or "none" for exclude
}
</script>

````
